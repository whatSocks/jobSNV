= Title of GraphGist
:neo4j-version: 2.1.0
:author: Your Name Here
:description: A sentence description.
:twitter: @yourTwitter,
:tags: domain:animals, use-case:social network 


== Table of Contents

* *<<introduction, Introduction>>*
* *<<the_network, The Network>>*
** <<network_subtopic1, Network Subtopic 1>>
* *<<problem_1, Describing and Solving Problem 1>>*
** <<problem_1_subtopic1, Problem 1 Subtopic 1>>
* *<<problem_2, Describing and Solving Problem 2>>*
** <<problem_2_subtopic1, Problem 2 Subtopic 1>>
* *<<conclusion, Conclusion>>*
** <<conclusion_subtopic1, Conclusion Subtopic 1>>
** <<why_neo, Why Neo4j?>>
* *<<use_case, Use Case: Use Case Name>>*
* *<<appendix, Cypher Appendix>>*
** <<cypher_subtopic_1, Cypher Subtopic 1>>
* *<<references, References>>*

[[introduction]]
== Introduction to GraphGist


[[the_network]]
== Using a Job Search Social Network to Target Potential Hires

=== Job Networking Platforms

For the majority of users, social networks--including professional networking sites--are free services used to connect with personal or professional contacts, join interest-specific groups, and network with potential employers, clients, or employees. The companies operating the social networks use various means to monetize their service, including sidebar ads from users and third parties, premium accounts that are free from these ads, and charging for presenting ads in the newsfeeds of particular users. 

Companies and individuals purchasing services like advertisements from social network sites want the best bang for their buck: they are paying a premium to present their ad to potential clients, and they would rather not 'waste' views on users that have no interest in the product in question. Social networking services use a variety of means to offer their customers the best access to high-value targets. For example, social networks offer targeted ads based on combinations of: 

- *User Interests*: For example, I can search for 'butterflies' on Amazon.com while logged into Facebook and am then presented with lepidopterae-related ads across Facebook
- *Social Network*:  For example, companies on Facebook can target ads at the friends of particular users, as these users presumably share relevant characteristics with the initial users, such as location and interests

=== This GraphGist 

This GraphGist explores targeted 'marketing' on job networking sites such as LinkedIn, Vieadeo, and Xing using a combination of the techniques above. Our toy professional networking site allows users and companies to use the site for free, but does charge for job posting, and offers several options on how to put the job posting in front of the most relevant (and hopefully qualified and interested) users. 

==== A brief description of professional netowrk:

Our toy netowork includes: 

- *Persons*: Persons, or the free users of the site, can be actively looking for work, happily employed and using the site to connect with fellow professionals, or a combination. Persons can make connections between themeselves and other Persons, the Company they work for, Groups they are a member of, Jobs they currently or desire topossess, and Skills they are interested in using.

- *Companies*: Companies in this example are interested in hiring the best talent, and are willing to pay to present job postings (Jobs) to targeted potential employees. 

- *Jobs*: Jobs are posted by Companies, connected to by Persons, and associated with Skills

- *Skills*: Associated with Persons and Jobs, Skills are used by Companies to find relelvant potential employees and by Persons to find relevant Jobs and Groups.

- *Groups*: Although Persons can form connections with other Persons that they know, Persons can join Groups based on common interests, which may or may not include Skills, previous employers, educational experiences, or other shared characteristics. 

==== Some loose ends:

Since this is an example network, we had to make the following abstractions:

- There's no time but the present. The network ignores past Person-Job relationships and assumes all job postings, group membership, and social connections are current
- Multiple people can have the same job, but jobs can only belong to one company
- Aside from id and a name, nodes don't have other traits, emphasizing the power of the connections and relationships

== Targeting Employment Ads: A Closer Look

From the point of view of the Companies driving the Jobs posting market, paying for job ads is costly. Not only does the posting cost money, the Company has to process and filter applicants, raising the cost of ineffective (or no) targeting. In short, Companies are willing to pay a premium for higher precision. Our toy network wants to offer Companies the option to advertise job postings in particular Groups, and will recommend the best Groups for a particular Company's hiring needs. 

Why not take the naive approach and look for groups with the highest proportion of members with target skills? Users want to be in a position where companies think they are high-value assets even though they may have less than ideal experience in the field. Users may also join Skill-specific groups due to general interest in learning about the Skill, because they want to network, or for a variety of other reasons. 

=== Planning Group Recommendations

We can take several paths to generate group recommendations for companies:

- Find groups that current employees are part of 
- Find groups that high-value users with target skill are part of

_See Aardvark example on how they select the best experts: experts that have a lot more friends with similar skills/knowledge give higher quality responses, maybe the same thing will happen here_


Can the social networking application offer some suggestions as to how to improve results? Same as above, with one change:

- Find groups that current employees of companies with _open_ jobs with relevant skills are members of

What might be a less good idea:

- Find groups with other users that have relevant skills are members of (this seems like a good idea for general networking and education, but perhaps it's naive - these groups may be too general)
-- this might give good recall, but poor precision

//hide
//setup
[source,cypher]
----
//create the User nodes
CREATE (`1`:Person {id:1, name:'Abeer Fathy'}), (`2`:Person {id:2, name:'An Yu-bao'}), (`3`:Person {id:3, name:'Anastasiya Vasilyev'}), (`4`:Person {id:4, name:'Anna Zaytesev'}), (`5`:Person {id:5, name:'Asley Leger'}), (`6`:Person {id:6, name:'Aziza Hsuang-tsung'}), (`7`:Person {id:7, name:'Bai Vasilyev'}), (`8`:Person {id:8, name:'Barbra Schon'}), (`9`:Person {id:9, name:'Bart Kosana'}), (`10`:Person {id:10, name:'Bill Hinzman'}), (`11`:Person {id:11, name:'Bill Cardille'}), (`12`:Person {id:12, name:'Bobba Fett'}), (`13`:Person {id:13, name:'Cai Shen'}), (`14`:Person {id:14, name:'Cammy Schott'}), (`15`:Person {id:15, name:'Cammy Vinogradov'}), (`16`:Person {id:16, name:'Cammy Sokolov'}), (`17`:Person {id:17, name:'Chan Morozov'}), (`18`:Person {id:18, name:'Chan Bang'}), (`19`:Person {id:19, name:'Charles Craig'}), (`20`:Person {id:20, name:'Chew Kwan-yew'}), (`21`:Person {id:21, name:'Chiang Popov'}), (`22`:Person {id:22, name:'Chiu Xiao-yong'}), (`23`:Person {id:23, name:'Dai Lu-fang'}), (`24`:Person {id:24, name:'Dariya Solovynov'}), (`25`:Person {id:25, name:'Dariya Semyonov'}), (`26`:Person {id:26, name:'Dariya Vorobyrov'}), (`27`:Person {id:27, name:'David Cardille'}), (`28`:Person {id:28, name:'Deeanna Lacroix'}), (`29`:Person {id:29, name:'Deng Szeto'}), (`30`:Person {id:30, name:'Dina Schott'})

//create the Company nodes
CREATE (`company1`:Company {id:1, name:'Salyut'}), (`company2`:Company {id:2, name:'Tiangong'}), (`company3`:Company {id:3, name:'Mir'}), (`company4`:Company {id:4, name:'Kosmos'}), (`company5`:Company {id:5, name:'Zvezda'}), (`company6`:Company {id:6, name:'Skylab'}), (`company7`:Company {id:7, name:'Genesis'}),(`company8`:Company {id:8, name:'World Medical Inc'}),(` company9`:Company {id:9, name:'Mining Inc'}), (`company10`:Company {id:10, name:'Absolute Engineering'}),(` company10`:Company {id:10, name:'Amazing Transportation'}), (`company12`:Company {id:12, name:'Whiskey Management'})

//create the Job nodes
CREATE (`job1`:Job {id:1, name:'Graphic Designer'}), (`job2`:Job {id:2, name:'Naval Engineer'})


//create the Skill nodes

CREATE (`skill1`:Skill {id:1, name:'SASS'}), (`skill2`:Skill {id:2, name:'Ruby'}), (`skill3`:Skill {id:3, name:'Java'}), (`skill4`:Skill {id:4, name:'ELISA'}), (`skill5`:Skill {id:5, name:'Excel'}), (`skill6`:Skill {id:6, name:'Marketing'}), (`skill7`:Skill {id:7, name:'Spanish'}),
(`skill8`:Skill {id:8, name:'R'}),(` skill9`:Skill {id:9, name:'Boating'}), (`skill10`:Skill {id:10, name:'Illustrator'}),(` skill10`:Skill {id:10, name:'InDesign'}), (`skill12`:Skill {id:12, name:'Photoshop'})


//create the Group nodes
CREATE (`group1`:Group {id:1, name:'SASS User Group'}), (`group2`:Group {id:2, name:'HTML5 Lovers'}), (`group3`:Group {id:3, name:'FrontEnd4Evr'}), (`group4`:Group {id:4, name:'AssayUserGroup'}), (`group5`:Group {id:5, name:'ChemStudents'}), (`group6`:Group {id:6, name:'BuyNowAndSave'}), (`group7`:Group {id:7, name:'SEOPros'}),(`group8`:Group {id:8, name:'useRs'}),(` group9`:Group {id:9, name:'Yachties'}), (`group10`:Group {id:10, name:'Adobe'})

//create the user-user relationships
CREATE (`2`)-[:KNOWS]->(`18`), (`2`)-[:KNOWS]->(`6`), (`3`)-[:KNOWS]->(`7`), (`3`)-[:KNOWS]->(`5`), (`4`)-[:KNOWS]->(`93`), (`5`)-[:KNOWS]->(`3`), (`6`)-[:KNOWS]->(`2`), (`7`)-[:KNOWS]->(`3`), (`8`)-[:KNOWS]->(`79`), (`8`)-[:KNOWS]->(`4`), (`9`)-[:KNOWS]->(`47`), (`9`)-[:KNOWS]->(`3`), (`9`)-[:KNOWS]->(`5`), (`10`)-[:KNOWS]->(`2`), (`10`)-[:KNOWS]->(`4`), (`10`)-[:KNOWS]->(`6`), (`11`)-[:KNOWS]->(`27`), (`11`)-[:KNOWS]->(`1`), (`11`)-[:KNOWS]->(`3`), (`11`)-[:KNOWS]->(`5`), (`12`)-[:KNOWS]->(`4`), (`12`)-[:KNOWS]->(`6`), (`13`)-[:KNOWS]->(`53`), (`13`)-[:KNOWS]->(`1`), (`14`)-[:KNOWS]->(`30`), (`14`)-[:KNOWS]->(`4`), (`15`)-[:KNOWS]->(`32`), (`15`)-[:KNOWS]->(`26`), (`15`)-[:KNOWS]->(`21`), (`15`)-[:KNOWS]->(`3`), (`15`)-[:KNOWS]->(`5`), (`16`)-[:KNOWS]->(`31`), (`16`)-[:KNOWS]->(`4`), (`17`)-[:KNOWS]->(`37`), (`17`)-[:KNOWS]->(`28`), (`18`)-[:KNOWS]->(`42`), (`18`)-[:KNOWS]->(`2`), (`19`)-[:KNOWS]->(`3`), (`19`)-[:KNOWS]->(`5`), (`20`)-[:KNOWS]->(`84`), (`20`)-[:KNOWS]->(`2`), (`21`)-[:KNOWS]->(`1`), (`21`)-[:KNOWS]->(`3`), (`21`)-[:KNOWS]->(`5`), (`22`)-[:KNOWS]->(`40`), (`22`)-[:KNOWS]->(`86`), (`22`)-[:KNOWS]->(`2`), (`24`)-[:KNOWS]->(`97`), (`24`)-[:KNOWS]->(`4`), (`25`)-[:KNOWS]->(`3`), (`25`)-[:KNOWS]->(`5`), (`26`)-[:KNOWS]->(`98`), (`26`)-[:KNOWS]->(`2`), (`26`)-[:KNOWS]->(`4`), (`26`)-[:KNOWS]->(`6`), (`27`)-[:KNOWS]->(`11`), (`27`)-[:KNOWS]->(`1`), (`27`)-[:KNOWS]->(`3`), (`27`)-[:KNOWS]->(`5`), (`28`)-[:KNOWS]->(`4`), (`29`)-[:KNOWS]->(`19`), (`29`)-[:KNOWS]->(`1`), (`30`)-[:KNOWS]->(`14`)

//user-group
CREATE (`3`)-[:MEMBER]->(`group1`), (`4`)-[:MEMBER]->(`group1`), (`5`)-[:MEMBER]->(`group1`), (`6`)-[:MEMBER]->(`group1`), (`7`)-[:MEMBER]->(`group1`), (`15`)-[:MEMBER]->(`group1`), (`30`)-[:MEMBER]->(`group1`), (`11`)-[:MEMBER]->(`group1`), (`15`)-[:MEMBER]->(`group1`), (`19`)-[:MEMBER]->(`group1`), (`47`)-[:MEMBER]->(`group1`), (`13`)-[:MEMBER]->(`group1`), (`7`)-[:MEMBER]->(`group1`), (`26`)-[:MEMBER]->(`group1`), (`17`)-[:MEMBER]->(`group1`), (`8`)-[:MEMBER]->(`group1`), (`18`)-[:MEMBER]->(`group1`), (`19`)-[:MEMBER]->(`group1`), (`92`)-[:MEMBER]->(`group1`), (`93`)-[:MEMBER]->(`group1`), (`7`)-[:MEMBER]->(`group1`), (`2`)-[:MEMBER]->(`group2`), (`6`)-[:MEMBER]->(`group2`), (`10`)-[:MEMBER]->(`group2`), (`13`)-[:MEMBER]->(`group2`), (`26`)-[:MEMBER]->(`group2`), (`6`)-[:MEMBER]->(`group2`), (`3`)-[:MEMBER]->(`group2`), (`8`)-[:MEMBER]->(`group2`), (`13`)-[:MEMBER]->(`group2`), (`16`)-[:MEMBER]->(`group3`)

//create job-skill relationships
CREATE (`job1`)-[:HAS_SKILL]->(`skill8`), (`job2`)-[:HAS_SKILL]->(`skill12`)

//create the user-skill relationships
CREATE (`2`)-[:HAS_SKILL]->(`skill8`), (`2`)-[:HAS_SKILL]->(`skill12`), (`3`)-[:HAS_SKILL]->(`skill12`), (`3`)-[:HAS_SKILL]->(`skill12`), (`4`)-[:HAS_SKILL]->(`skill3`), (`5`)-[:HAS_SKILL]->(`skill12`), (`6`)-[:HAS_SKILL]->(`skill12`), (`7`)-[:HAS_SKILL]->(`skill12`), (`8`)-[:HAS_SKILL]->(`skill9`), (`8`)-[:HAS_SKILL]->(`skill12`), (`9`)-[:HAS_SKILL]->(`skill7`), (`9`)-[:HAS_SKILL]->(`skill12`), (`9`)-[:HAS_SKILL]->(`skill12`), (`10`)-[:HAS_SKILL]->(`skill12`), (`10`)-[:HAS_SKILL]->(`skill12`), (`10`)-[:HAS_SKILL]->(`skill12`), (`11`)-[:HAS_SKILL]->(`skill7`), (`11`)-[:HAS_SKILL]->(`skill12`), (`11`)-[:HAS_SKILL]->(`skill12`), (`11`)-[:HAS_SKILL]->(`skill12`), (`12`)-[:HAS_SKILL]->(`skill12`), (`12`)-[:HAS_SKILL]->(`skill12`), (`13`)-[:HAS_SKILL]->(`skill3`), (`13`)-[:HAS_SKILL]->(`skill12`), (`14`)-[:HAS_SKILL]->(`skill0`), (`14`)-[:HAS_SKILL]->(`skill12`), (`15`)-[:HAS_SKILL]->(`skill `), (`15`)-[:HAS_SKILL]->(`skill `), (`15`)-[:HAS_SKILL]->(`skill1`), (`15`)-[:HAS_SKILL]->(`skill `), (`15`)-[:HAS_SKILL]->(`skill `), (`16`)-[:HAS_SKILL]->(`skill1`), (`16`)-[:HAS_SKILL]->(`skill12`), (`17`)-[:HAS_SKILL]->(`skill7`), (`17`)-[:HAS_SKILL]->(`skill8`), (`18`)-[:HAS_SKILL]->(`skill2`), (`18`)-[:HAS_SKILL]->(`skill12`), (`19`)-[:HAS_SKILL]->(`skill12`), (`19`)-[:HAS_SKILL]->(`skill12`), (`20`)-[:HAS_SKILL]->(`skill4`), (`20`)-[:HAS_SKILL]->(`skill12`), (`21`)-[:HAS_SKILL]->(`skill12`), (`21`)-[:HAS_SKILL]->(`skill12`), (`21`)-[:HAS_SKILL]->(`skill12`), (`22`)-[:HAS_SKILL]->(`skill0`), (`22`)-[:HAS_SKILL]->(`skill6`), (`22`)-[:HAS_SKILL]->(`skill12`), (`24`)-[:HAS_SKILL]->(`skill7`), (`24`)-[:HAS_SKILL]->(`skill12`), (`25`)-[:HAS_SKILL]->(`skill12`), (`25`)-[:HAS_SKILL]->(`skill12`), (`26`)-[:HAS_SKILL]->(`skill8`), (`26`)-[:HAS_SKILL]->(`skill12`), (`26`)-[:HAS_SKILL]->(`skill12`), (`26`)-[:HAS_SKILL]->(`skill12`), (`27`)-[:HAS_SKILL]->(`skill1`), (`27`)-[:HAS_SKILL]->(`skill12`), (`27`)-[:HAS_SKILL]->(`skill12`), (`27`)-[:HAS_SKILL]->(`skill12`), (`28`)-[:HAS_SKILL]->(`skill12`), (`29`)-[:HAS_SKILL]->(`skill9`), (`29`)-[:HAS_SKILL]->(`skill12`), (`30`)-[:HAS_SKILL]->(`skill4`), (`30`)-[:HAS_SKILL]->(`skill12`)

//create the job-company relationshps
CREATE (`job1`)-[:JOB_AT]->(`company3`), (`job2`)-[:JOB_AT]->(`company2`)

//create the user-company relationships
CREATE (`1`)-[:WORKS_AT]->(`company1`), (`2`)-[:WORKS_AT]->(`company2`), (`3`)-[:WORKS_AT]->(`company3`), (`4`)-[:WORKS_AT]->(`company1`), (`5`)-[:WORKS_AT]->(`company2`), (`6`)-[:WORKS_AT]->(`company3`), (`7`)-[:WORKS_AT]->(`company1`), (`8`)-[:WORKS_AT]->(`company2`), (`9`)-[:WORKS_AT]->(`company3`), (`10`)-[:WORKS_AT]->(`company1`), (`11`)-[:WORKS_AT]->(`company2`), (`12`)-[:WORKS_AT]->(`company3`), (`13`)-[:WORKS_AT]->(`company1`), (`14`)-[:WORKS_AT]->(`company2`), (`15`)-[:WORKS_AT]->(`company3`), (`16`)-[:WORKS_AT]->(`company1`), (`17`)-[:WORKS_AT]->(`company2`), (`18`)-[:WORKS_AT]->(`company3`), (`19`)-[:WORKS_AT]->(`company1`), (`20`)-[:WORKS_AT]->(`company2`)

RETURN *
LIMIT 50
----
// graph_result

=== A Closer Look at the User Network

[source,cypher]
----
MATCH (s:Skill)-[:HAS_SKILL]-(p:Person)-[:MEMBER]-(g:Group)
RETURN g.name AS Group, s. AS SKILL, count(DISTINCT p) AS `Number of People`
ORDER BY People DESC, g.name ASC 
LIMIT 10
----
//table

Look at all the pretty users. 


=== A Closer Look at the Job Network


Let's see what jobs are available

[source,cypher]
----
MATCH (c:Company)-[:JOB_AT]-(j:Job)-[:HAS_SKILL]-(p:Skill)
RETURN c.name AS Company, j.name AS Job, p.name AS `Skills Required`
LIMIT 10
----
//table

[[problem_1]]
== Finding the Best Group in which to Advertise

Recap:
From the company POV, paying for job ads is costly, they want to have high precision. Can the social network offer companies a "you should advertise in XYZ group" recommendation feature? 

What would recommendation be based on?

- Find groups that current employees are part of 
- Find groups that high-value users with target skill are part of
-- See Aardvark example on how they select the best experts: experts that have a lot more friends with similar skills/knowledge give higher quality responses, maybe the same thing will happen here


Let's see how each method works out for us:

=== Finding Target Groups through Current Employees 

[source,cypher]
----
MATCH (p:Person)-[:WORKS_AT]-(c:Company)-[:JOB_AT]-(j:Job), (p)-[:MEMBER]-(g:Group)
RETURN DISTINCT c.name AS Company, j.name AS Job, g.name AS `Target Groups`, count(DISTINCT p) AS `Count of Member Employees`
ORDER BY `Count of Member Employees` DESC
LIMIT 10
----
//table


=== Finding Target Groups through Current Employees _with a Similar Skill Set_

[source,cypher]
----
MATCH (c:Company)-[:JOB_AT]-(j:Job)-[:HAS_SKILL]-(s:Skill),(s)-[:HAS_SKILL]-(p:Person)-[:WORKS_AT]-(c),(p)-[:MEMBER]-(g:Group)
RETURN DISTINCT c.name AS Company, j.name AS Job, s.name AS `Skills Required`, g.name AS Group, count(DISTINCT p) AS `Count of Member Employees`
ORDER BY `Count of Member Employees` DESC
LIMIT 10
----
//table


Although going through current employees is generally positive, what if a company has no contacts in a particular skill set? 

=== Finding Target Groups with Highest Number of 'Experts'

First, find an expert, as defined by someone with lots people in his or her network with the same skills. 

[source,cypher]
----
MATCH (s:Skill)-[:HAS_SKILL]-(expert:Person)-[:KNOWS]-(a:Person)-[:HAS_SKILL]-(s)
RETURN DISTINCT s.name AS Skill, count(DISTINCT expert) AS `Count of Experts`
ORDER BY `Count of Experts` DESC
LIMIT 10
----
//table

What groups are these super-experts in? Are they different than the groups generic experts are in?

[source,cypher]
----
MATCH (s:Skill)-[:HAS_SKILL]-(expert:Person)-[:KNOWS]-(a:Person)-[:HAS_SKILL]-(s),(expert)-[:MEMBER]-(g:Group)
RETURN DISTINCT g.name as Group, s.name AS Skill, count(DISTINCT expert) AS `Count of Experts`
ORDER BY `Count of Experts` DESC
LIMIT 10
----
//table



[[problem_1_subtopic1]]
=== Problem 1 Subtopic 1

==== _Describe and solve the problem with prose and Cypher!_


[[problem_2]]
== Describing and Solving Problem 2

=== _Describe and solve the problem with prose and Cypher!_

_Insert image of problem/solution here. Sample image below._

image::http://i.imgur.com/DvwWxMI.png[example]


[[problem_2_subtopic1]]
=== Problem 2 Subtopic 1

==== _Describe and solve the problem with prose and Cypher!_


[[conclusion]]
== Conclusion

_Problems solved, battles won...Jacob has a handful of friends interested in hyraxes._

[[conclusion_subtopic1]]
=== Conclusion Subtopic 1

[[why_neo]]
=== Why Neo4j?

image:https://dl.dropboxusercontent.com/u/14493611/neo4j-logo.png[Neo4j Logo]


_Explain why Neo4j was used._

[[use_case]]
== Use Case: Use Case Name

_logo of use case here_

_Describe use case here._

[[appendix]]
== Cypher Appendix

[[cypher_subtopic_1]]
=== Cypher Subtopic 1

----
//CYPHER HERE. For example:
MATCH (a:sample)
RETURN a
----

_Explanation of non-trivial Cypher queries used._

[[references]]
== References

_some sample references:_

- Frederick, Michael T., Pallab Datta, and Arun K. Somani. "Sub-Graph Routing: A generalized fault-tolerant strategy for link failures in WDM Optical Networks." Computer Networks 50.2 (2006): 181-199.
- 'http://en.wikipedia.org/wiki/Samuel_Johnson[Networks, Crowds, and Markets]'
- 'http://jexp.de/blog/2014/03/sampling-a-neo4j-database/[Sampling a Neo4j Database]'
